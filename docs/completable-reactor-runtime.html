<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<title>Completable Reactor Concept</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_completable_reactor_concept">Completable Reactor Concept</h2>
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
Describes concept behind CompletableReactor.
Explains how we can decompose concurrent conditional execution into base graph components.
Shows how reactor components could be described in code and how they visualized.
</blockquote>
</div>
<div class="paragraph">
<p>To describe and idea behind CompletableReactor let&#8217;s start with simple model and then evolve it step by step.</p>
</div>
<div class="sect2">
<h3 id="_simple_sequential_model">Simple sequential model</h3>
<div class="paragraph">
<p>This model consists of two base elements: <strong>Payload</strong> and <strong>Vertex</strong>.
Payload is a simple <a href="https://en.wikipedia.org/wiki/Plain_old_Java_object">POJO</a>.
Vertex is active element of model that takes Payload, execute business logic based on that Payload.
Then vertex execute computation and stores computation result inside this Payload.
Then vertex passes this Payload to the next Vertex.
All Vertices linked in chain one after another.
Modification of Payload is optional for Vertex.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/simple-sequential-model.png" alt="simple sequential model">
</div>
</div>
<div class="paragraph">
<p>In given example we have two vertices and single payload object.
Payload consists of two fields: x and result.
MultiplyVertex reads x from payload, multiplies it by 2 and stores computation result in result field.
StdoutVertex does not modify incoming payload and simply prints result field to stdout.</p>
</div>
</div>
<div class="sect2">
<h3 id="_sequential_asynchronous_handler_merger_model">Sequential asynchronous handler-merger model</h3>
<div class="paragraph">
<p>Now lets make our vertices work asynchronously.
We will split computation logic of vertices in two parts.
First one, called <code>Handler</code>, will read input data from payload and perform computation.
Second one, called <code>Merger</code>, will store computation result inside payload.
Handler will be asynchronous function and Merger will be synchronous.
Here is an example how to split MultiplyVertex logic to handler and merger functions: handler will read
argument x from payload, then asynchronously perform multiplication and return CompletableFuture of this operation.
Merger will get result of handler function as an argument and will store it inside payload in result filed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>CompletableFuture&lt;Integer&gt; handle(Payload payload){
    return CompletableFuture.supplyAsync(()-&gt;{
        return payload.getX() * 2;
    });
}

void merge(Payload paylaod, int result){
    paylaod.setResult(result);
}</pre>
</div>
</div>
<div class="paragraph">
<p>Visual representation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/sequential-async-handler-merger-model.png" alt="sequential async handler merger model">
</div>
</div>
<div class="paragraph">
<p>Visual representation of such computation contains several items:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Handler</strong> bar that represent asynchronous computation of handler function</p>
</li>
<li>
<p><strong>Merger</strong> circle that represent synchronous computation of merger function</p>
</li>
<li>
<p><strong>Transition</strong> between handler and merger that carries two objects: payload and computation result
of handler function.</p>
</li>
<li>
<p><strong>Transition</strong> that goes into Handler and carries single object - Payload.</p>
</li>
<li>
<p><strong>Transition</strong> that goes out of Merger and carries single object - Payload.</p>
</li>
<li>
<p><strong>Payload</strong> object that goes into Handler, then to Merger then out of Merger.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now we can simplify visual notation and hide implicit Payload and handler function result.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/sequential-async-handler-merger-model-simplified.png" alt="sequential async handler merger model simplified">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parallel_handler_merger_model">Parallel handler-merger model</h3>
<div class="paragraph">
<p>Lets update Merger and allow it to have several outgoing transitions. When merger function
completes merging process it will send reference to same Payload instance through all of outgoing transitions in parallel.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/parallel-handler-merger-multiple-outgoing.png" alt="parallel handler merger multiple outgoing">
</div>
</div>
<div class="paragraph">
<p>In given example origin Payload and vertex Result goes from Handler to Merger.
Then Merger modifies Payload and puts result inside it.
Then Merger sends this Payload instance that contains result 20 to all outgoing transitions.</p>
</div>
<div class="paragraph">
<p>Now we need another feature in Merger - an ability to join two incoming transitions into single outgoing.
When Merger have two incoming transitions: one from Vertex that carries Payload with handler Result and another
with Payload only, Merger will chose Result from first transition and will merge it to Payload that it received from second transition.
For activation Merger has to wait for both incoming transitions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/parallel-handler-merger-join-flows.png" alt="parallel handler merger join flows">
</div>
</div>
<div class="paragraph">
<p>In given illustration there are two incoming transitions into Merger.
First incoming transition carries Payload and computation result of Handler2 - value 42.
Second incoming transition carries ony Payload.
Merger takes reference to Payload and Result from first transition.
Merges them together by merger function and passes Payload to outgoing transition.</p>
</div>
<div class="paragraph">
<p>Now we are ready to make big step to parallel execution.
As an example lets implement purchasing process.
Suppose that customer with identifier <code>userId</code> wants to buy product with identifier <code>item</code>.
During purchase process we have to reserve money on users account and reserve product in our storage.
<code>BillingService</code> will provide asynchronous method to reserve money. And StorageFacility will provide asynchronous method to reserve product in the storage.
We can require reservation in parallel in both services and then if both services successfully performed reservation we can return answer to the user which purchase accomplished successfully.
Plain class <code>Purchase</code> will serve as payload object in our model.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Purchase{
    Long userId;
    Long item;
    Boolean moneyReserved;
    Boolean productReserved;
    Boolean result;
}</pre>
</div>
</div>
<div class="paragraph">
<p><code>userId</code> and <code>item</code> will identify customer and requested product. <code>moneyReserved</code> and <code>productReserved</code> fields will keep information about reservation status returned from BillingService and StorageFacility.
Lets visualize execution graph and discuss execution steps in detail.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/parallel-handler-merger-computation-example.png" alt="parallel handler merger computation example">
</div>
</div>
<div class="paragraph">
<p>As a first step we create Purchase payload and populate <code>userid</code> and item.
Suppose that first Merger at the top simply sends this Payload into two places in parallel:
to BillingService Vertex and StorageFacility Vertex.
StorageFacility runs reservation logic and send via outgoing transitions two  objects:
origin Purchase payload and product reservation status.
BillingService runs reservation logic and send via outgoing transition two objects:
origin Purchase payload and money reservation status.
Left Merger that belongs to BillingService Vertex waits for BillingService to complete.
After that Merger takes money reservation status and puts in into Purchase payload
(by using it&#8217;s merger function) and sends this Payload through outgoing transition to Merger
on right side of the graph.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>//BillingService Vertex Merger
void merge(Purchase paylaod, BillingServiceStatus billingStatus){
    if(billingStatus == RESERVED){
        paylaod.setMoneyReserved(true);
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Right Merger that belongs to StorageFacility Vertex waits two incoming transitions: with StorageFacility
result and with Payload from BillingService.
Then it takes StorageFacility product reservation status and puts it into Payload that came from BillingService processor.
This payload already contains information about BillingService operation status. After that Merger checks both fields: <code>Purchase.moneyReserved</code> and <code>Purchase.productReserved</code>.
If both fields are true, Merger sets <code>Purchase.result</code> to true. This means that purchase accomplished
successfully.
This process is done by using merge function of StorageFacility MergePoint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>//StorageFacility Merger
void merge(Purchase paylaod, StorageFacilityStatus storageStatus){
    if(storageStatus == RESERVED){
        paylaod.setProductReserved(true);
    }
    if(paylaod.getMoneyReserved() &amp;&amp; payload.getProductReserved()){
        payload.setResult(true);
    } else {
        payload.setResult(false);
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Then StorageFacility Merger sends Payload with BillingService and StorageFacility results through outgoing transition at the end of the given graph.</p>
</div>
<div class="paragraph">
<p>Now we can simplify visualisation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/parallel-handler-merger-computation-example-simplified.png" alt="parallel handler merger computation example simplified">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_handler_merger_model_with_conditional_transitions">Handler-merger model with conditional transitions</h3>
<div class="paragraph">
<p>We almost there. Fasten seat belts.
Lets enrich our Merger with last feature: conditional transitions:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/merger-conditional-outgoing-flows.png" alt="merger conditional outgoing flows">
</div>
</div>
<div class="paragraph">
<p>Each outgoing transitions now have enum value associated with it. In graph this enum value illustrated as text label near arrows.
Merger function signature is changed too. Now merger should return enum that will control which outgoing transition will be activated and which is not.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Enum merge(Payload payload, HandlerResult handlerResult) {...}</pre>
</div>
</div>
<div class="paragraph">
<p>When Merger is activated by incoming transition it evaluates merger function and checks merger result.
After that Merger marks all outgoing transitions which associated enum values does not match
merger function result as dead and deactivates them.
Also Merger activates all outgoing transitions which associated with enum values that matches
merger function result.
If there are two or more outgoing transitions that matches enum function result then all of them activates and runs in parallel.
In given illustration we can control how graph will execute.
If Merger function return FIRST then two outgoing transitions will run in parallel.
If Merger function return SECOND then only single transition will run.</p>
</div>
<div class="paragraph">
<p>It is important to mention that when at least one of incoming transition of Merger is marked as dead
then Merger itself marked as dead, it does not execute and simply marks all outgoing transitions as dead too.
When  Handler have several incoming transitions and one of them is marked as dead
then there is nothing happens with Handler. Only if all incoming transitions marked as dead Handler dies too and
marks outgoing transition as dead.
In other worlds Handler waits result of all incoming transitions.
If all incoming transitions dies - Handler dies.
If single incoming transition survives - Handler executes.
If there are more that one active incoming transitions survives - Handlers rise an error.
This is inconsistent graph configuration.
Merger in same manner waits result of all incoming transitions.
But if any of incoming transitions dies - Merger dies too.
To execute Merger should have all incoming transitions to be alive.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/merger-conditional-outgoing-example.png" alt="merger conditional outgoing example">
</div>
</div>
<div class="paragraph">
<p>In given example if Merger returns FIRST then:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Vertex1 and Vertex2 execute in parallel, Vertex3 dies.</p>
</li>
<li>
<p>Then runs Merger1 and Merger3 dies.</p>
</li>
<li>
<p>Then runs Merger2</p>
</li>
<li>
<p>Then Vertex4 executes.</p>
</li>
<li>
<p>Then runs Merger4</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If Merger returns SECOND then:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Vertex1 and Vertex2 dies. Vertex3 executes.</p>
</li>
<li>
<p>Then runs Merger3 and Merger1 with Merger2 dies.</p>
</li>
<li>
<p>Then Vertex4 executes.</p>
</li>
<li>
<p>Then runs Merger4.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_startpoint_and_endpoints">StartPoint and EndPoints</h3>
<div class="paragraph">
<p>The difficult part is over. Now let discuss how to start execution and how to stop it.
StartPoint specify position where Payload start it trip over graph. There is only one StartPoint for each graph.
EndPoints defines places where execution of the graph is stops and current Payload is returned
as a graph computation result.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/start-point-and-end-point.png" alt="start point and end point">
</div>
</div>
<div class="paragraph">
<p>In given illustration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Graph execution starts at StartPoint.</p>
</li>
<li>
<p>Then Payload goes to Vertex1 and Vertex2 in parallel.</p>
</li>
<li>
<p>Then Merger1 executes.</p>
</li>
<li>
<p>Then Merger2 executes.</p>
</li>
<li>
<p>Then if Merger2 returns FIRST  graph execution stops at left EndPoint</p>
</li>
<li>
<p>Otherwise if Merger2 returns SECOND execution continues</p>
</li>
<li>
<p>Vertex3 with Merger3 runs sequentially and after that graph execution stops ant bottom EndPoint</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_completable_reactor_runtime">Completable Reactor Runtime</h2>
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
Completable Reactor Runtime enriches Handler-Merger execution concept with new components
and determines its execution on JVM.
</blockquote>
</div>
<div class="sect2">
<h3 id="_payload_and_startpoint">Payload and StartPoint</h3>
<div class="paragraph">
<p>Payload is a plain old java object that encapsulates request, response
and intermediate computation data required for request processing.
CompletableReactor receives payload as an argument.
Executes business flows, modifies payload during execution and returns it as a result.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Purchase{
    //request parameters
    //provided by user during graph launching
    Long userId;
    Long productId;

    //intermediate data, used to pass information
    //from one vertex to another vertex
    Boolean moneyReservationStatus;
    Boolean productReservationStatus;

    //results
    //that user receives when graph execution is complete
    Boolean purchaseStatus;
}</pre>
</div>
</div>
<div class="paragraph">
<p>We can add little structure to payload to clarify purpose of each field
and make our graph code more readable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Purchase{
    Request request;
    Intermediate intermediate;
    Response response;

    Purchase(Long userId, Long productId){
        this.request = new Request(userId, productId);
    }

    static class Request{
        Long userId;
        Long productId;

        Request(Long userId, Long productId){
            this.userId = userId;
            this.productId = productId;
        }
    }
    static class Intermediate{
        Boolean moneyReservationStatus;
        Boolean productReservationStatus;
    }
    static class Response{
        Boolean purchaseStatus;
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>To launch graph user should create Payload instance and submit it to reactor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>//launch graph
Execution&lt;Purchase&gt; execution = completableReactor.submit(new Purchase(107, 42));

//wait for graph to complete
Purchase purchase = execution.getResultFuture().get();

//check result
System.out.print( purchase.getResponse().getPurchaseStatus() );</pre>
</div>
</div>
<div class="paragraph">
<p>Start point visualization:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/start-point.png" alt="start point">
</div>
</div>
<div class="paragraph">
<p>To attach vertices to StartPoint you can use <code>payload()</code> builder method of graph.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class PurchaseGraph extends Graph&lt;Purchase&gt;{

    Vertex reserveMoney = ...
    Vertex reserveProduct = ...

    {
        payload()
                .handleBy(reserveMoney)
                .handleBy(reserveProduct);
    }
}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/start-point-handle-by.png" alt="start point handle by">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vertices">Vertices</h3>
<div class="paragraph">
<p>Vertex is a visual graph item that represent a handler and optional merger invocation.
Vertex encapsulates coupled business logic that can be reused in different branches.
There are three types of vertices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Handlers with or without Mergers</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>    Vertex vx = handler(...).withMerger(...);
    Vertex vx = handler(...).withRoutingMerger(...);
    Vertex vx = handler(...).withoutMerger();</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Subgraphs</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>    Vertex vx = subgraph(...).withMerger(...);
    Vertex vx = subgraph(...).withRoutingMerger(...);
    Vertex vx = subgraph(...).withoutMerger();</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Routers and Mutators</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>    Vertex vx = router(...);
    Vertex vx = mutator(...);</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_handlers_and_mergers">Handlers and Mergers</h3>
<div class="paragraph">
<p>Handler is an asynchronous function that takes information from Payload and returns computation result.
Handler implements asynchronous part of business logic of the execution flow.
It could be reused in different flows branches several time.
Handler <code>MUST NOT</code> change Payload because same instance of Payload passed to other handlers in parallel.
Is is ok to concurrently read payload from several handlers but not to modify payload.
The only point of payload modification is Merger.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Vertex reserveMoney =
        handler(
            // Reserve required amount of money for the purchase in the bank
            payload -&gt; bank.reserve(payload.getAccountId(), payload.getAmount())
        )
        ...;</pre>
</div>
</div>
<div class="paragraph">
<p>Merger is a synchronous function that takes Handlers computation result and uses it to update Payload.
It is safe to modify payload within merger.</p>
</div>
<div class="paragraph">
<p>There are several types of Mergers: RoutingMerger, Merger and EmptyMerger.</p>
</div>
<div class="sect3">
<h4 id="_with_routing_merger">With Routing Merger</h4>
<div class="paragraph">
<p>Routing Merger can change Payload and should always return enum value that defines outgoing transition.
Graph will continue to execute by this transition returned from RoutingMerger function.
In given example we send request to bank.
Then we saves reservation result in payload and return transition value depending on reservation result.
Graph will continue to execute by transition that will be selected based on enum value returned by RoutingMerger.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Vertex reserveMoney =
        handler(
            // Reserve required amount of money for the purchase in the bank
            payload -&gt; bank.reserve(payload.getAccountId(), payload.getAmount())

        ).withRoutingMerger((payload, result) -&gt; {
            if(result.getStatus() == OK){
                payload.moneyReserved = true;
                return RESERVED;

            } if(result.getStatus() == NO_MONEY){
                payload.moneyReserved = false;
                payload.reservateionFailReason = NO_MONEY;
                return NO_MONEY;

            } else {
                payload.moneyReserved = false;
                payload.reservateionFailReason = OTHER_REASON;
                return OTHER_REASON;
            }
        });
}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/routing-merger.png" alt="routing merger">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_with_merger">With Merger</h4>
<div class="paragraph">
<p>If the only thing you need is to modify Payload and unconditionally continue to execute graph
by the next Vertex, then you need to use Merger.
Merger works in a same way as RoutingMerger but it is not required for Merger to return any value.
In given example we send notification and save it&#8217;s result in payload.
But graph execution path does not depend on notification result.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Vertex sendNotification =
        handler(
            payload -&gt; notificatior.sendNotification(
                    payload.getUserId(),
                    "You are purchasing " + payload.getServiceTitle())

        ).withMerger((payload, result) -&gt; {
            if(result.getStatus() == OK){
                payload.isNotificationSent = true;

            }
        });
}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/merger.png" alt="merger">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_without_merger">Without Merger</h4>
<div class="paragraph">
<p>Last option with mergers is not to use them at all and not to wait for async operation completeness.
Handler will be executed in parallel with other vertices but will not trigger any outgoing transitions because such vertex does not have any.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Vertex fireStatisticEvent =
        handler(
            payload -&gt; statistic.fireEvent(
                    new PurchaseEvent(
                        payload.getUserId(),
                        payload.getServiceId())
                    )

        ).withoutMerger();
}
...
businessAction
    .onAny().handleBy(fireStatisticEvent);
//no outgoing transitions for fireStatisticEvent</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/without-merger.png" alt="without merger">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connect_vertices_into_graph">Connect vertices into graph</h3>
<div class="paragraph">
<p>No we can connect described vertices into graph.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    payload()
        .handleBy(reserveMoney)
        .handleBy(sendNotification)
        .handleBy(fireStatisticEvent);

    sendNotification
        .onAny().mergeBy(reserveMoney);

    reserveMoney
        .on(RESERVED).handleBy(trySendEmail)
        .on(NO_MONEY).complete()
        .on(OTHER_REASON).complete();

    trySendEmail
        .onAny().complete()
}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/mergers-example.png" alt="mergers example">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transition">Transition</h3>
<div class="paragraph">
<p>Transition is a Enum instance that represent jumps between graph items during flow execution.
RoutingMerger returns instance of Enum.
Outgoing transition will be activated according to this value.
If merger returns status PLAN_B, then all outgoing transitions with condition status PLAN_B
will be activated and all transitions without PLAN_B status will be deactivated
or marked as dead transition.
Unconditional transitions <code>onAny</code> will be always activated regardless of the Routing Merger result.
EmptyMerger and Merger work as a RoutingMerger that returns internal default merge status that
could participate only in <code>onAny</code> transitions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>enum MyTransitions{
    ONE_WAY,
    ANOTHER_WAY
}

{
    vx1
        .on(ON_WAY).handleBy(vx2)
        .on(ANOTHER_WAY).handleBy(vx3);

    vx2
        .onAny().handleBy(vx4);
}</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>handleBy</code> transition connect Merers, Routers and Mutators to Handlers, Subgraphs, Routers and Mutators.</p>
</li>
<li>
<p><code>mergeBy</code> transition connect Merers, Routers and Mutators to Mergers.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_endpoint">EndPoint</h3>
<div class="paragraph">
<p>EndPoint is a visual graph item that indicates end of flow execution.
When graph execution reaches EndPoint then all transitions marked as terminated
and CompletableReactor immediately returns graph result.
The only exception is Handlers and Subgraphs without mergers.
They will continue to execute but their execution result will be ignored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Execution&lt;Purchase&gt; execution = reactor.submit(new Purchase(100, 42));

//chain execution future completes when all vertices, including
//Handlers and Subgraphs without mergers are complete and graph reached EndPoint.
execution.getChainExecutionFuture()

//chain result future completes when graph reaches EndPoint
execution.getResultFutureFuture()</pre>
</div>
</div>
<div class="paragraph">
<p>Yuy can attach EndPoint to any of transition withing reactor graph.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    vx3.onAny().complete()</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/endpoint.png" alt="endpoint">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subgraph">Subgraph</h3>
<div class="paragraph">
<p>Subgraph - is a Vertex that allows to invoke one graph from another.
It simply submits constructed child Payload to CompletableReactor.
Subgraph has implicit Handler that takes Payload as argument and returns Payload
as computation result.
Subgraphs allows us to reuse graphs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Vertex bonusPurchase =
        subgraph(
                Purchase.class,
                paylaod -&gt; new Purchase(payload.userId, payload.bonusServiceId)
        ).withMerger(...)</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/subgraph.png" alt="subgraph">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_routers_and_mutators">Routers and Mutators</h3>
<div class="ulist">
<ul>
<li>
<p>Router is a synchronous function that works as RoutingMerger.
It can modify payload.
Outgoing transition activated depending ot Router result.</p>
</li>
<li>
<p>Mutator works as Merger.
It can only modify payload and does not return any value.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Vertex vx1 = router(
        paylaod -&gt; {
            payload.data = ...;
            return ONE_WAY;

        });

Vertex vx2 = mutator(
        paylaod -&gt; {
            payload.data = ...;
        });</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/routers-and-mutators.png" alt="routers and mutators">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_merger_decision">Merger decision</h3>
<div class="paragraph">
<p>If all of outgoing transitions from Merger have distinct statuses
then flow will continue to execute only one of transitions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/merger-decision.png" alt="merger decision">
</div>
</div>
<div class="paragraph">
<p>If Merger will return FAIL status then execution completes immediately.
In case of FIRST status flow will continue and Handler2 will be invoked.
In case of SECOND status - Handler3 will be invoked.
In given example there could be three options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Payload &#8594; Handler1 &#8594; Merger1 &#8594; End (if merger returns FAIL status)</p>
</li>
<li>
<p>Payload &#8594; Handler1 &#8594; Merger1 &#8594; Handler2 &#8594; Merger2 &#8594; End (if merger returns FIRST status)</p>
</li>
<li>
<p>Payload &#8594; Handler1 &#8594; Merger1 &#8594; Handler3 &#8594; Merger3 &#8594; End (if merger returns SECOND status)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At first payload goes to Handler1.
Then framework waits when CompletableFuture returned by Handler1 completes.
After that Merger will be invoked and Payload with Handler1 result will be passed to this merger.
Merger will check Handler1 result, modifies Payload if needed and returns one of statuses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FAIL</p>
</li>
<li>
<p>FIRST</p>
</li>
<li>
<p>SECOND.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After that execution will continue along with one of transitions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FAIL leads to END</p>
</li>
<li>
<p>FIRST - to Handler1</p>
</li>
<li>
<p>SECOND - to Handler3.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_parallel_execution">Parallel execution</h3>
<div class="paragraph">
<p>If two transitions have same condition Status then flow will continue execution in parallel and both transitions will be activated.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/parallel-execution.png" alt="parallel execution">
</div>
</div>
<div class="paragraph">
<p>In given example there could be three options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>merger1 returns FAIL status:<br>
Payload &#8594; Handler1 &#8594; Merger1 &#8594; End</p>
</li>
<li>
<p>merger1 returns OK, merger3 returns FAIL:<br>
Payload &#8594; Handler1 &#8594; Merger1 &#8594; Handler2, Handler3 &#8594; Merger3 &#8594; End</p>
</li>
<li>
<p>merger1 returns OK, merger3 returns OK:<br>
Payload &#8594; Handler1 &#8594; Merger1 &#8594; Handler2, Handler3 &#8594; Merger3 &#8594; Merger 2 &#8594; continue</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>CompletableReactor will wait until result of Handler1 is ready.
Then it sends Handler1 result to Merger1.
Merger1 analyzes Handler1 result, mutates Payload instance if needed and then returns merge status.
If this status is FAIL then flow execution stops.
If this status is OK then framework launches Handler2 and Handler3 in parallel.
Merger2 have two incoming transitions.
It will wait until all of them is complete and only then will launch merging function.
Suppose Handler2 will finish first.
Merger2 will have to wait for second incoming transition from Merger3.
When Handler3 result is complete, Merger3 will be executed.
If Merger3 returns FAIL then all flows stops.
If Merger3 returns OK then transition from Merger3 to Merger2 activates.
Then Merger2 executes.
This will leads us to deterministic order of Payload modification and Processors execution.
Handlers could be launched in parallel and provided with same reference to Payload.
But no two mergers can runs concurrently in this configuration of the graph.
Payload always modified by mergers graph sequentially.
In general sequential modification of payload is not necessary.
We can build graph with two concurrently running Mergers.
In that case payload will be modified by these Mergers concurrently.</p>
</div>
</div>
<div class="sect2">
<h3 id="_detached_handler_without_merger">Detached  Handler without Merger</h3>
<div class="paragraph">
<p>Some times we are not interesting in computation result of Handler.
We simply need to invoke async method and does not care about it&#8217;s result.
It could be Notification service that sends message to external system and
current flow business is not depend on notification result.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/detached-without-merger.png" alt="detached without merger">
</div>
</div>
<div class="paragraph">
<p>We passing Payload to Hanlder6 by reference.
In that case there could be concurrent reading data by Handler6
and data reading or modification in one of Vertices that will be triggered
after Merger2 is complete.
To exclude problems with concurrency Handler6 should only read and use data
that will not be modified by last part of the graph.
Or Handler6 could simply copy data and continue to work with local copy.
Merger2 will launch Handler6 function first, and only after receiving CompletableFuture of
computation result of Hanlder6 Merger2 will trigger outgoing transition to Merger1.
That behaviour will secure Handler 6 invocation and allows it to safely read payload
without expecting of concurrent modification of payload by Merger1.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Vertex handler6 =
        handler( payload -&gt; {

            // It is safe to read data from payload even if they are going to be modified by Merger1
            // Merger1 will be invoked after this method returns CompletableFuture result.

            MutableData data = payload.getMutableData().clone()
            CompletableFuture&lt;ServiceResult&gt; result = asyncService.doAction(data);

            // After we return result Merger1 will be invoked.
            // But asyncService will continue to run with it's own copy of MutableData.
            return result;
            }
        ).withoutMerger();
}</pre>
</div>
</div>
<div class="paragraph">
<p>We can avoid this difficulties if we will follow simple rule:
Populate Payload with new data and handlers results and do not modify this results if you are using them
in detached handlers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Vertex handler6 =
        handler(
            // It is safe to pass data without copying if we know That
            // now vertices after current one  in the graph will not try to modify this data.
            // Or even better: when Data is simply immutable.
            payload -&gt; asyncService.doAction(paylaod.getData());
        ).withoutMerger();
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_detached_handler_with_merger">Detached Handler with Merger</h3>
<div class="paragraph">
<p>Some times we want to launch Handler execution in parallel with main flow and we interested in result.
In that case we also have to pass copy of Payload data to async function of Handler6
or use immutable arguments to prevent concurrent reading by Handler6  async function and data modification by
other Vertices of the graph like we did in Detached Handler without Merger scenario.
Also we have to use Merger to bring Handler6 result back to main flow.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/detached-with-merger.png" alt="detached with merger">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conditional_execution">Conditional execution</h3>
<div class="ulist">
<ul>
<li>
<p>Handlers, Routers and Mutators works as logical OR <code>||</code>.
Vertex waits for all incoming transition to complete.
If some transitions marked as dead and there is at least one alive transition - vertex will run
and send paylaod through outgoing transitions.
Otherwise if all transitions are dead - vertex will not run.</p>
</li>
<li>
<p>Mergers works as logical AND <code>&amp;&amp;</code>.
Vertex waits for all incoming transition to complete.
If at least one transition mareked as daed - vertex will not run.
All outgoing transitions will be marked as dead.
Otherwise if all incoming transition are alive - then vertex will run
and send payload through outgoing transitions.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="completable-reactor-runtime/conditional-execution-or-and.png" alt="conditional execution or and">
</div>
</div>
<div class="paragraph">
<p>Lets discuss an example where we have two cases in our graph.
First one: when we execute handler A, handler B and handler C in parallel.
Second one: when we execute handler A, handler B and we do not need to run C at all.
We can implement this behaviour through several approaches.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Simple approach with concurrent Mergers</p>
<div class="ulist">
<ul>
<li>
<p>Use conditional transition for vertex <code>C</code>.
Mergers of <code>B</code> and <code>C</code> executed concurrently.<br>
<span class="image"><img src="completable-reactor-runtime/conditional-execution-4.png" alt="conditional execution 4"></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>Complex approach with sequential Mergers</p>
<div class="ulist">
<ul>
<li>
<p>Use conditional transition with optional handling and merging<br>
<span class="image"><img src="completable-reactor-runtime/conditional-execution-1.png" alt="conditional execution 1"></span></p>
</li>
<li>
<p>Use conditional transition with vertex cloning<br>
<span class="image"><img src="completable-reactor-runtime/conditional-execution-2.png" alt="conditional execution 2"></span></p>
</li>
<li>
<p>Always run vertex C. Use if-else logic inside handler <code>C</code>
and simply do nothing in handler itself.<br>
<span class="image"><img src="completable-reactor-runtime/conditional-execution-3.png" alt="conditional execution 3"></span></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vertex_template_function">Vertex template function</h3>
<div class="paragraph">
<p>It is possible to use a function as a vertex builder to create vertices with similar functionality.
Builder function can have arguments and must be defined in same source file as graph itself.</p>
</div>
<div class="paragraph">
<p>Instead of creating two similar logging vertices buy copy-pasting code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>val successLog =
    handler(
        paylaod -&gt; {
            if(paylaod.getAction().isTraceable()){
                logEvent("success", payload.getAction(), paylaod.getUserInfo())
            }
        }
    ).withoutMerger();

val failureLog =
    handler(
        paylaod -&gt; {
            if(paylaod.getAction().isTraceable()){
                logEvent("failure", payload.getAction(), paylaod.getUserInfo())
            }
        }
    ).withoutMerger();
...
.on(SUCCESS).handleBy(successLog)
.on(FAILURE).handleBy(failureLog)</pre>
</div>
</div>
<div class="paragraph">
<p>you can use vertex template function instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Vertex loggingVertex(String message){
    return handler(
            paylaod -&gt; {
                if(paylaod.getAction().isTraceable()){
                    logEvent(message, payload.getAction(), paylaod.getUserInfo())
                }
            }
        ).withoutMerger();
}

val successLog = loggingVertex("success");
val failureLog = loggingVertex("failure");
...
.on(SUCCESS).handleBy(successLog)
.on(FAILURE).handleBy(failureLog)</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-11-02 09:56:11 MSK
</div>
</div>
</body>
</html>